#!/bin/bash

display_usage() {
    echo -e "\n Call update-repos.sh and give it a path to search recursively"
    echo -e "\n Examples:  ./update-repos ~/bin"
    echo -e "\n            ./update-repos /opt\n"
}

check_default_branch() {
    default_branch=$(git remote show REMOTE_REPO_NAME | grep 'HEAD branch' | cut -d' ' -f5)
    echo -e "default branch detected as: $default_branch"
}

if [  -z "$1" ]
then
	display_usage
	exit 1
fi

if [[ ( $1 == "--help") ||  $1 == "-h" ]]
then
	display_usage
	exit 0
fi 

topdir=$1

for i in $(find $topdir -name ".git" 2>/dev/null); do
    echo "";
    echo "${i%????}";
    cd "${i%????}";
    git checkout $default_branch
    git up
done

